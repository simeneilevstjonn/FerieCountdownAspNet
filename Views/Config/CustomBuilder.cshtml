@model CustomBuilderViewModel
@using FerieCountdown.Classes.Countdowns;
@{
    Layout = "_Container";
    ViewData["Title"] = Model.Title;
}

<h1>@Model.Heading</h1>
<form asp-area="" asp-controller="Config" asp-action="@Model.Action">
    <br />
    @foreach (FormInput fi in Model.FormInputs)
    {
        <div class="form-group">
            <label for="@fi.Name">@fi.Description</label>
            <input type="@Html.Raw(fi.Type)" class="form-control" id="@fi.Name" name="@fi.Name" placeholder="@fi.Placeholder" required>
        </div>
    }

    <script>
        function PreviewImage(img) {
            var uri;
            switch (img) {
                @foreach (CountdownBackground cb in Model.BackgroundOptions)
                {
                <text>
                case "@cb.Id":
                    uri = "@cb.Path";
                    break;
                </Text>
                }
            }
            document.getElementById("imgpreview").style.backgroundImage = "url(" + uri + ")";
            document.getElementById("imgpreview").style.display = "block";
            }
    </script>
    <div class="form-group">
        <label for="bg-select">Bakgrunn</label>
        <select class="form-control" id="bg-select" name="background" onchange="PreviewImage(this.value)" required>
            <option selected disabled>-</option>
            @foreach (CountdownBackground cb in Model.BackgroundOptions)
            {
                <option value="@cb.Id">@cb.CommonName</option>
            }
        </select>
    </div>

    <input type="hidden" name="g-recaptcha-response" id="g-recaptcha-response" />

    <div id="imgpreview" style="width: 512px; height: 288px; margin-left:auto;margin-right:auto; margin-bottom: 1em; background-position:center; background-repeat: no-repeat; background-size: 100% 100%;display:none;"></div>
    <button type="submit" class="btn btn-primary mb-2">Lagre</button>
</form>

<script src="https://www.google.com/recaptcha/api.js?render=6Ld59roUAAAAAED1YHj-tlIv0TfEsGamVXXOVBS0"></script>
<script>
    grecaptcha.ready(function () {
        grecaptcha.execute('6Ld59roUAAAAAED1YHj-tlIv0TfEsGamVXXOVBS0', { action: 'createcelebration' }).then(function (token) {
            document.getElementById("g-recaptcha-response").value = token;
        });
    });
</script>

