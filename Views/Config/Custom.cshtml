@model CustomBuilderViewModel
@using FerieCountdown.Classes.Countdowns;
@{
    Layout = "_Container";
    ViewData["Title"] = Model.Title;
}

<h1>@Model.Heading</h1>
<form asp-area="" asp-controller="Config" asp-action="@Model.Action">
    <br />
    <div class="form-group">
        <label for="cdtext">Nedtellingstekst</label>
        <input type="text" class="form-control" id="cdtext" name="cdtext" placeholder="Nedtelling til arrangement" required>
    </div>
    <div class="form-group">
        <label for="endtext">Tekst når nedtellingen er ferdig</label>
        <input type="text" class="form-control" id="endtext" name="endtext" placeholder="Arrangement er nå" required>
    </div>
    <div class="row">
        <div class="form-group col">
            <label for="time">Nedtellingstidspunkt</label>
            <input type="datetime-local" class="form-control" id="time" name="time" value="@DateTime.UtcNow.ToString("u").Replace(' ', 'T').Substring(0, 17)" min="@DateTime.UtcNow.ToString("u").Replace(' ', 'T').Substring(0, 17)" max="2038-01-19T03:14" required>
            
        </div>
        <div class="form-group col">
            <label for="timezone">Tidssone</label>
            <select class="form-control" required id="timezone" name="timezone">
                <option value="utc" selected>UTC (Coordinated Universal Time)</option>
                <option value="local">Brukerens lokaltid</option>
            </select>
        </div>
    </div>
    <div class="form-group">
        <label for="recursion">Gjentakelse</label>
        <select class="form-control" required id="recursion" name="recursion">
            <option value="none" selected>Ingen gjentakelse</option>
            <option value="yearly">Årlig gjentakelse</option>
        </select>
    </div>


    <script>
        function PreviewImage(img) {
            var uri;
            switch (img) {
                @foreach (CountdownBackground cb in Model.BackgroundOptions)
                {
                <text>
                case "@cb.Id":
                    uri = "@cb.Path";
                    break;
                </Text>
                }
            }
            document.getElementById("imgpreview").style.backgroundImage = "url(" + uri + ")";
            document.getElementById("imgpreview").style.display = "block";
            }
    </script>
    <div class="form-group">
        <label for="bg-select">Bakgrunn</label>
        <select class="form-control" id="bg-select" name="background" onchange="PreviewImage(this.value)" required>
            <option selected disabled>-</option>
            @foreach (CountdownBackground cb in Model.BackgroundOptions)
            {
                <option value="@cb.Id">@cb.CommonName</option>
            }
        </select>
    </div>

    <input type="hidden" name="g-recaptcha-response" id="g-recaptcha-response" />

    <div id="imgpreview" style="width: 512px; height: 288px; margin-left:auto;margin-right:auto; margin-bottom: 1em; background-position:center; background-repeat: no-repeat; background-size: 100% 100%;display:none;"></div>
    <button type="submit" class="btn btn-primary mb-2">Lagre</button>
</form>

<script src="https://www.google.com/recaptcha/api.js?render=6Ld59roUAAAAAED1YHj-tlIv0TfEsGamVXXOVBS0"></script>
<script>
    grecaptcha.ready(function () {
        grecaptcha.execute('6Ld59roUAAAAAED1YHj-tlIv0TfEsGamVXXOVBS0', { action: 'contact' }).then(function (token) {
            document.getElementById("g-recaptcha-response").value = token;
        });
    });
</script>